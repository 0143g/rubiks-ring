PS M:\mikerson\rubiks\python-port> python .\gan_raw_stream.py
9dd006d0b39605bc891cea688b94abdbc124dec1
cbea4ed308df6c77c31afee4d02ad6b297c406be
451ed604dc7535c778ba89a6f617e18dbac4244b
b066cb4009a3e86232e655b76bf61ab6f49130e0
5b729a665086910ee3b1f6ee89dcb22ec1b3aff3
1d7ca2954c5459d038c0c762b99a01fffd055576
313a01ed46ed9b03739d4290fb61c8ac6020e01c
f63bde5365bdb74d38d8061411c61e2d2b7ed4fb
f9f1acb95df53889e265614586fd8a0304224f75
ac35092431594504b7a0ebdeb41e7628ce7ee868
d5619216b4251354ff6d090ecaed07ded30a1d8d
56d1fca847ad926081e427f8da0258d297dacc77
f4426d4cbce7029f697452af5972f70597fb5135
5a11e480849a1989e5cd21ad725861491a1d1dfb
e3c76fd21720f71bc873cf0723194774b2194d83
4a98f7416fb0b24eef91af3de207d148553717c8
6f6de0446a3b63b211843b234d20c0e794ee0ac7
ea6372ce4a15b48c510ac8955e6dbab5ead8271f
60552867049d02766d254bf931c7638d9dd01a4c
f95df498a8ae0b6b0778e8e5852bf1e8e51243f1
b5dafb9d8d86d852014b464c14c52cc65ea6d97d
279342bd53b34a9cfd0b6444a3e3b4a74e4dcbb4
25229671fe7ad306ba68ea798c460606289dcb41
7b5803ecc8f31b862ffa62c979cb69c3ad9a3451
2132b1756cc5d9cf3d1708c166eb6f3bf861f0b7
d3ca1a0d18871e707e4b29e43a7682f4756610ef

PS M:\mikerson\rubiks\python-port> python .\gan_decode_demo.py

================================================================================
GAN CUBE BLUETOOTH PACKET DECODER - EDUCATIONAL DEMO
================================================================================

This demonstrates the complete decoding pipeline:
1. AES-CBC decryption with MAC-based salt
2. Event type identification from bit patterns
3. Bit-level field extraction
4. Value normalization (quaternions, moves, etc.)


********************************************************************************
PACKET 1
********************************************************************************

================================================================================
RAW HEX PACKET: 9dd006d0b39605bc891cea688b94abdbc124dec1
================================================================================

1. AES DECRYPTION
   MAC Address: D3:CA:1A:0D:18:87
   Salt (reversed MAC): 87180d1acad3
   Key (first 6 bytes salted): 881a4f42fb6516072005185442111253
   IV (first 6 bytes salted): 981b3f42ebd476272095781432120243

   DECRYPTED BYTES: 778b2a8bb4b7ed2c6f006156007530b27bbd4aed
   Binary: 01110111 10001011 00101010 10001011

2. EVENT TYPE IDENTIFICATION
   First byte: 0x77 = 01110111
   Event type (bits 0-3): 0111 = 0x7
   Event name: UNKNOWN_07

3. EVENT-SPECIFIC PARSING
   Raw data: 778b2a8bb4b7ed2c6f006156007530b27bbd4aed

4. FINAL DECODED RESULT
   {'type': 'UNKNOWN_07', 'raw': '778b2a8bb4b7ed2c6f006156007530b27bbd4aed'}


********************************************************************************
PACKET 2
********************************************************************************

================================================================================
RAW HEX PACKET: cbea4ed308df6c77c31afee4d02ad6b297c406be
================================================================================

1. AES DECRYPTION
   MAC Address: D3:CA:1A:0D:18:87
   Salt (reversed MAC): 87180d1acad3
   Key (first 6 bytes salted): 881a4f42fb6516072005185442111253
   IV (first 6 bytes salted): 981b3f42ebd476272095781432120243

   DECRYPTED BYTES: e001edae9c5b105822bab8c5b2cbd3e8b050b285
   Binary: 11100000 00000001 11101101 10101110

2. EVENT TYPE IDENTIFICATION
   First byte: 0xE0 = 11100000
   Event type (bits 0-3): 1110 = 0xE
   Event name: UNKNOWN_0E

3. EVENT-SPECIFIC PARSING
   Raw data: e001edae9c5b105822bab8c5b2cbd3e8b050b285

4. FINAL DECODED RESULT
   {'type': 'UNKNOWN_0E', 'raw': 'e001edae9c5b105822bab8c5b2cbd3e8b050b285'}


********************************************************************************
PACKET 3
********************************************************************************

================================================================================
RAW HEX PACKET: 451ed604dc7535c778ba89a6f617e18dbac4244b
================================================================================

1. AES DECRYPTION
   MAC Address: D3:CA:1A:0D:18:87
   Salt (reversed MAC): 87180d1acad3
   Key (first 6 bytes salted): 881a4f42fb6516072005185442111253
   IV (first 6 bytes salted): 981b3f42ebd476272095781432120243

   DECRYPTED BYTES: 486111f3dbe6aa65e2e0153a7187f9a9235eb294
   Binary: 01001000 01100001 00010001 11110011

2. EVENT TYPE IDENTIFICATION
   First byte: 0x48 = 01001000
   Event type (bits 0-3): 0100 = 0x4
   Event name: FACELETS

3. EVENT-SPECIFIC PARSING
   Raw data: 486111f3dbe6aa65e2e0153a7187f9a9235eb294

4. FINAL DECODED RESULT
   {'type': 'FACELETS', 'raw': '486111f3dbe6aa65e2e0153a7187f9a9235eb294'}


================================================================================
DECODING SUMMARY
================================================================================

üîê ENCRYPTION:
  ‚Ä¢ Uses AES-128-CBC with MAC address as salt
  ‚Ä¢ Salt = reversed MAC bytes
  ‚Ä¢ Key/IV first 6 bytes modified by (base + salt) % 0xFF
  ‚Ä¢ Decrypts in two chunks: bytes[4:20] then bytes[0:16]

üìä EVENT IDENTIFICATION:
  ‚Ä¢ Event type in bits 0-3 of first byte
  ‚Ä¢ 0x01 = Orientation (quaternion)
  ‚Ä¢ 0x02 = Move (face turns)
  ‚Ä¢ 0x09 = Battery level

üî¢ BIT-LEVEL PARSING:
  ‚Ä¢ Data packed at arbitrary bit boundaries
  ‚Ä¢ Quaternions: 16 bits each (1 sign + 15 magnitude)
  ‚Ä¢ Moves: 5 bits per move (4 face + 1 direction)
  ‚Ä¢ Timestamps: 16 bits for elapsed time

üìê NORMALIZATION:
  ‚Ä¢ Quaternions: raw/0x7FFF with sign from bit 15
  ‚Ä¢ Moves: face index to URFDLB notation
  ‚Ä¢ Direction: 0=CW, 1=CCW (prime notation)

‚úÖ DECODED EVENT TYPES:
  ‚Ä¢ UNKNOWN_07: 1 packet(s)
  ‚Ä¢ UNKNOWN_0E: 1 packet(s)
  ‚Ä¢ FACELETS: 1 packet(s)
